{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# this is a program to slice my mouse brain RNAseq results \n",
    "\n",
    "CSV file is \"original_cd320.KOB12neg_vs_ctrlB12neg\"\n",
    "\n",
    "path is dbernard/Documents/DJB files/Brody Lab/mouse CD320/Brain RNA seq experiment/Brain RNAseq analysis by McGaughey/"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import numpy as np\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Gene</th>\n",
       "      <th>Source</th>\n",
       "      <th>Chr</th>\n",
       "      <th>Start</th>\n",
       "      <th>End</th>\n",
       "      <th>baseMean</th>\n",
       "      <th>log2FoldChange</th>\n",
       "      <th>log2FoldChangeUncorrected</th>\n",
       "      <th>lfcSE</th>\n",
       "      <th>stat</th>\n",
       "      <th>...</th>\n",
       "      <th>Control.Normal.B12_10</th>\n",
       "      <th>Control.Normal.B12_15</th>\n",
       "      <th>KO.B12_Deficient.B12_03</th>\n",
       "      <th>KO.B12_Deficient.B12_04</th>\n",
       "      <th>KO.B12_Deficient.B12_06</th>\n",
       "      <th>KO.B12_Deficient.B12_07</th>\n",
       "      <th>KO.Normal.B12_01</th>\n",
       "      <th>KO.Normal.B12_08</th>\n",
       "      <th>KO.Normal.B12_11</th>\n",
       "      <th>KO.Normal.B12_12</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Tmem181a</td>\n",
       "      <td>HAVANA</td>\n",
       "      <td>chr17</td>\n",
       "      <td>6270470</td>\n",
       "      <td>6308314</td>\n",
       "      <td>14902.552866</td>\n",
       "      <td>-0.686035</td>\n",
       "      <td>-0.712041</td>\n",
       "      <td>0.017077</td>\n",
       "      <td>-40.172218</td>\n",
       "      <td>...</td>\n",
       "      <td>18346.249782</td>\n",
       "      <td>18475.883409</td>\n",
       "      <td>11224.547655</td>\n",
       "      <td>11321.244681</td>\n",
       "      <td>11175.307230</td>\n",
       "      <td>11333.126407</td>\n",
       "      <td>11434.949103</td>\n",
       "      <td>11357.689735</td>\n",
       "      <td>11390.642607</td>\n",
       "      <td>11424.623768</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Cd320</td>\n",
       "      <td>HAVANA</td>\n",
       "      <td>chr17</td>\n",
       "      <td>33843091</td>\n",
       "      <td>33849774</td>\n",
       "      <td>176.246376</td>\n",
       "      <td>-1.195882</td>\n",
       "      <td>-6.074842</td>\n",
       "      <td>0.043120</td>\n",
       "      <td>-27.733483</td>\n",
       "      <td>...</td>\n",
       "      <td>300.828145</td>\n",
       "      <td>367.548311</td>\n",
       "      <td>1.964394</td>\n",
       "      <td>9.866868</td>\n",
       "      <td>2.164499</td>\n",
       "      <td>6.732741</td>\n",
       "      <td>4.370490</td>\n",
       "      <td>4.140986</td>\n",
       "      <td>7.076582</td>\n",
       "      <td>2.035386</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Gm16867</td>\n",
       "      <td>HAVANA</td>\n",
       "      <td>chr14</td>\n",
       "      <td>69363504</td>\n",
       "      <td>69503362</td>\n",
       "      <td>1749.882377</td>\n",
       "      <td>-0.696872</td>\n",
       "      <td>-0.870387</td>\n",
       "      <td>0.036290</td>\n",
       "      <td>-19.202594</td>\n",
       "      <td>...</td>\n",
       "      <td>2202.872764</td>\n",
       "      <td>2258.910973</td>\n",
       "      <td>1294.535685</td>\n",
       "      <td>1178.104074</td>\n",
       "      <td>1206.708073</td>\n",
       "      <td>1251.327969</td>\n",
       "      <td>1364.466867</td>\n",
       "      <td>1271.282745</td>\n",
       "      <td>1241.055493</td>\n",
       "      <td>1282.293421</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Entpd4</td>\n",
       "      <td>HAVANA</td>\n",
       "      <td>chr14</td>\n",
       "      <td>69337174</td>\n",
       "      <td>69367270</td>\n",
       "      <td>5582.269809</td>\n",
       "      <td>-0.492651</td>\n",
       "      <td>-0.551765</td>\n",
       "      <td>0.028132</td>\n",
       "      <td>-17.512058</td>\n",
       "      <td>...</td>\n",
       "      <td>6801.703024</td>\n",
       "      <td>6552.499203</td>\n",
       "      <td>4684.097634</td>\n",
       "      <td>4298.007829</td>\n",
       "      <td>4510.815469</td>\n",
       "      <td>4420.525245</td>\n",
       "      <td>4662.438352</td>\n",
       "      <td>4484.687990</td>\n",
       "      <td>4729.810206</td>\n",
       "      <td>4548.070873</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Pyroxd2</td>\n",
       "      <td>ENSEMBL</td>\n",
       "      <td>chr19</td>\n",
       "      <td>42725858</td>\n",
       "      <td>42752775</td>\n",
       "      <td>210.092764</td>\n",
       "      <td>0.622038</td>\n",
       "      <td>1.512406</td>\n",
       "      <td>0.045080</td>\n",
       "      <td>13.798491</td>\n",
       "      <td>...</td>\n",
       "      <td>97.075749</td>\n",
       "      <td>102.367567</td>\n",
       "      <td>296.623503</td>\n",
       "      <td>301.926170</td>\n",
       "      <td>314.934573</td>\n",
       "      <td>304.896976</td>\n",
       "      <td>334.779507</td>\n",
       "      <td>303.327235</td>\n",
       "      <td>353.829078</td>\n",
       "      <td>309.378730</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 29 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       Gene   Source    Chr     Start       End      baseMean  log2FoldChange  \\\n",
       "0  Tmem181a   HAVANA  chr17   6270470   6308314  14902.552866       -0.686035   \n",
       "1     Cd320   HAVANA  chr17  33843091  33849774    176.246376       -1.195882   \n",
       "2   Gm16867   HAVANA  chr14  69363504  69503362   1749.882377       -0.696872   \n",
       "3    Entpd4   HAVANA  chr14  69337174  69367270   5582.269809       -0.492651   \n",
       "4   Pyroxd2  ENSEMBL  chr19  42725858  42752775    210.092764        0.622038   \n",
       "\n",
       "   log2FoldChangeUncorrected     lfcSE       stat        ...         \\\n",
       "0                  -0.712041  0.017077 -40.172218        ...          \n",
       "1                  -6.074842  0.043120 -27.733483        ...          \n",
       "2                  -0.870387  0.036290 -19.202594        ...          \n",
       "3                  -0.551765  0.028132 -17.512058        ...          \n",
       "4                   1.512406  0.045080  13.798491        ...          \n",
       "\n",
       "   Control.Normal.B12_10  Control.Normal.B12_15  KO.B12_Deficient.B12_03  \\\n",
       "0           18346.249782           18475.883409             11224.547655   \n",
       "1             300.828145             367.548311                 1.964394   \n",
       "2            2202.872764            2258.910973              1294.535685   \n",
       "3            6801.703024            6552.499203              4684.097634   \n",
       "4              97.075749             102.367567               296.623503   \n",
       "\n",
       "   KO.B12_Deficient.B12_04  KO.B12_Deficient.B12_06  KO.B12_Deficient.B12_07  \\\n",
       "0             11321.244681             11175.307230             11333.126407   \n",
       "1                 9.866868                 2.164499                 6.732741   \n",
       "2              1178.104074              1206.708073              1251.327969   \n",
       "3              4298.007829              4510.815469              4420.525245   \n",
       "4               301.926170               314.934573               304.896976   \n",
       "\n",
       "   KO.Normal.B12_01  KO.Normal.B12_08  KO.Normal.B12_11  KO.Normal.B12_12  \n",
       "0      11434.949103      11357.689735      11390.642607      11424.623768  \n",
       "1          4.370490          4.140986          7.076582          2.035386  \n",
       "2       1364.466867       1271.282745       1241.055493       1282.293421  \n",
       "3       4662.438352       4484.687990       4729.810206       4548.070873  \n",
       "4        334.779507        303.327235        353.829078        309.378730  \n",
       "\n",
       "[5 rows x 29 columns]"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df = pd.read_csv(\"original_cd320.koB12neg_vs_ctrlB12neg_copy.csv\")\n",
    "df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Gene</th>\n",
       "      <th>Source</th>\n",
       "      <th>Chr</th>\n",
       "      <th>Start</th>\n",
       "      <th>End</th>\n",
       "      <th>baseMean</th>\n",
       "      <th>log2FoldChange</th>\n",
       "      <th>log2FoldChangeUncorrected</th>\n",
       "      <th>lfcSE</th>\n",
       "      <th>stat</th>\n",
       "      <th>...</th>\n",
       "      <th>Control.Normal.B12_10</th>\n",
       "      <th>Control.Normal.B12_15</th>\n",
       "      <th>KO.B12_Deficient.B12_03</th>\n",
       "      <th>KO.B12_Deficient.B12_04</th>\n",
       "      <th>KO.B12_Deficient.B12_06</th>\n",
       "      <th>KO.B12_Deficient.B12_07</th>\n",
       "      <th>KO.Normal.B12_01</th>\n",
       "      <th>KO.Normal.B12_08</th>\n",
       "      <th>KO.Normal.B12_11</th>\n",
       "      <th>KO.Normal.B12_12</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>19987</th>\n",
       "      <td>Vmn2r73</td>\n",
       "      <td>HAVANA</td>\n",
       "      <td>chr7</td>\n",
       "      <td>85857547</td>\n",
       "      <td>85875938</td>\n",
       "      <td>0.061520</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.001917</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19988</th>\n",
       "      <td>Wfdc21</td>\n",
       "      <td>HAVANA</td>\n",
       "      <td>chr11</td>\n",
       "      <td>83746940</td>\n",
       "      <td>83752642</td>\n",
       "      <td>0.109917</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.001917</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.874098</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.884573</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19989</th>\n",
       "      <td>Zdhhc25</td>\n",
       "      <td>HAVANA</td>\n",
       "      <td>chr15</td>\n",
       "      <td>88600302</td>\n",
       "      <td>88601669</td>\n",
       "      <td>0.054631</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.001917</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.874098</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19990</th>\n",
       "      <td>Zfp352</td>\n",
       "      <td>HAVANA</td>\n",
       "      <td>chr4</td>\n",
       "      <td>90218820</td>\n",
       "      <td>90225702</td>\n",
       "      <td>0.064703</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.001917</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>1.035247</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19991</th>\n",
       "      <td>Zfp616</td>\n",
       "      <td>HAVANA</td>\n",
       "      <td>chr11</td>\n",
       "      <td>74069955</td>\n",
       "      <td>74087292</td>\n",
       "      <td>0.061520</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.001917</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 29 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "          Gene  Source    Chr     Start       End  baseMean  log2FoldChange  \\\n",
       "19987  Vmn2r73  HAVANA   chr7  85857547  85875938  0.061520             0.0   \n",
       "19988   Wfdc21  HAVANA  chr11  83746940  83752642  0.109917             0.0   \n",
       "19989  Zdhhc25  HAVANA  chr15  88600302  88601669  0.054631             0.0   \n",
       "19990   Zfp352  HAVANA   chr4  90218820  90225702  0.064703             0.0   \n",
       "19991   Zfp616  HAVANA  chr11  74069955  74087292  0.061520             0.0   \n",
       "\n",
       "       log2FoldChangeUncorrected     lfcSE  stat        ...         \\\n",
       "19987                        0.0  0.001917   0.0        ...          \n",
       "19988                        0.0  0.001917   0.0        ...          \n",
       "19989                        0.0  0.001917   0.0        ...          \n",
       "19990                        0.0  0.001917   0.0        ...          \n",
       "19991                        0.0  0.001917   0.0        ...          \n",
       "\n",
       "       Control.Normal.B12_10  Control.Normal.B12_15  KO.B12_Deficient.B12_03  \\\n",
       "19987                    0.0                    0.0                      0.0   \n",
       "19988                    0.0                    0.0                      0.0   \n",
       "19989                    0.0                    0.0                      0.0   \n",
       "19990                    0.0                    0.0                      0.0   \n",
       "19991                    0.0                    0.0                      0.0   \n",
       "\n",
       "       KO.B12_Deficient.B12_04  KO.B12_Deficient.B12_06  \\\n",
       "19987                      0.0                      0.0   \n",
       "19988                      0.0                      0.0   \n",
       "19989                      0.0                      0.0   \n",
       "19990                      0.0                      0.0   \n",
       "19991                      0.0                      0.0   \n",
       "\n",
       "       KO.B12_Deficient.B12_07  KO.Normal.B12_01  KO.Normal.B12_08  \\\n",
       "19987                      0.0          0.000000          0.000000   \n",
       "19988                      0.0          0.874098          0.000000   \n",
       "19989                      0.0          0.874098          0.000000   \n",
       "19990                      0.0          0.000000          1.035247   \n",
       "19991                      0.0          0.000000          0.000000   \n",
       "\n",
       "       KO.Normal.B12_11  KO.Normal.B12_12  \n",
       "19987          0.000000               0.0  \n",
       "19988          0.884573               0.0  \n",
       "19989          0.000000               0.0  \n",
       "19990          0.000000               0.0  \n",
       "19991          0.000000               0.0  \n",
       "\n",
       "[5 rows x 29 columns]"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.tail()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Gene</th>\n",
       "      <th>log2FoldChange</th>\n",
       "      <th>padj</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Tmem181a</td>\n",
       "      <td>-0.686035</td>\n",
       "      <td>2.966812e-13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Cd320</td>\n",
       "      <td>-1.195882</td>\n",
       "      <td>2.966812e-13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Gm16867</td>\n",
       "      <td>-0.696872</td>\n",
       "      <td>2.966812e-13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Entpd4</td>\n",
       "      <td>-0.492651</td>\n",
       "      <td>2.966812e-13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Pyroxd2</td>\n",
       "      <td>0.622038</td>\n",
       "      <td>2.966812e-13</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       Gene  log2FoldChange          padj\n",
       "0  Tmem181a       -0.686035  2.966812e-13\n",
       "1     Cd320       -1.195882  2.966812e-13\n",
       "2   Gm16867       -0.696872  2.966812e-13\n",
       "3    Entpd4       -0.492651  2.966812e-13\n",
       "4   Pyroxd2        0.622038  2.966812e-13"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#slice file to get only the columns for Gene, log2FoldChange and padj in newdf\n",
    "\n",
    "newdf = df.loc[:,['Gene','log2FoldChange','padj']]\n",
    "newdf.head()\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Add a graphical view of the data here - maybe plot padj value or log2FoldChange \n",
    "# ideas - volano plot?\n",
    "# can I make a PCA graph here ????\n",
    "    # if I did, I'd need to slice some more and only take the top 500 or 1000 rows \n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [],
   "source": [
    "#save sliced dataframe as .csv file\n",
    "\n",
    "newdf.to_csv(r'/Users/dbernard/newdf.txt', sep = '\\t', index = False)\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "5"
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "file = open('test.csv','w')\n",
    "file.write(\"newdf\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "This newdf file can now be uploaded for use in \n",
    "Partek Genomics Suite or \n",
    "Ingenuity Pathway Analysis \n",
    "or other pathway analysis tools"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.0"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
